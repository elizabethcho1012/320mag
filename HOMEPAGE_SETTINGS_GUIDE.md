# 홈페이지 슬라이드 설정 기능 구현 완료

## 구현된 기능

관리자 페이지에서 메인 페이지의 슬라이드를 완전히 제어할 수 있는 시스템을 구현했습니다.

### 주요 기능

1. **슬라이드 개수 설정**
   - 전체 슬라이드 수 (1-20개)
   - 기사 슬라이드 수
   - 광고 슬라이드 수

2. **기사 카테고리 선택**
   - 슬라이드에 표시할 카테고리 선택 (다중 선택 가능)
   - 선택된 카테고리의 최신 기사가 슬라이드에 표시됨

3. **자동 재생 설정**
   - 슬라이드 자동 재생 활성화/비활성화
   - 슬라이드 전환 간격 설정 (밀리초 단위)

## 구현된 파일

### 1. 데이터베이스 마이그레이션
**파일**: [supabase/migrations/011_homepage_settings.sql](supabase/migrations/011_homepage_settings.sql)

홈페이지 설정을 저장하는 테이블을 생성합니다:
- `total_slides`: 전체 슬라이드 수
- `article_slides`: 기사 슬라이드 수
- `ad_slides`: 광고 슬라이드 수
- `slide_categories`: 슬라이드에 표시할 카테고리 (JSON 배열)
- `autoplay_enabled`: 자동 재생 활성화 여부
- `autoplay_interval`: 슬라이드 전환 간격 (밀리초)

### 2. React Hook
**파일**: [src/hooks/useHomepageSettings.ts](src/hooks/useHomepageSettings.ts)

홈페이지 설정을 조회하고 업데이트하는 hook:
- `useHomepageSettings()`: 설정 조회
- `useUpdateHomepageSettings()`: 설정 업데이트

### 3. 관리자 페이지 설정 UI
**파일**: [src/pages/AdminPage.tsx](src/pages/AdminPage.tsx)

관리자 페이지의 "설정" 메뉴에 홈페이지 설정 UI 추가:
- 슬라이드 개수 입력 폼
- 카테고리 선택 체크박스
- 자동 재생 설정
- 실시간 유효성 검사 (기사 + 광고 수가 전체 슬라이드 수를 초과하지 않도록)

### 4. 홈페이지 동적 슬라이드
**파일**: [src/pages/HomePage.tsx](src/pages/HomePage.tsx)

설정에 따라 동적으로 슬라이드를 구성:
- 설정된 카테고리의 최신 기사 선택
- 광고를 슬라이드에 삽입
- 자동 재생 간격 적용
- 광고 클릭 시 새 창으로 링크 열기

## 사용 방법

### 1단계: 데이터베이스 마이그레이션 실행

Supabase Dashboard에서 SQL Editor를 열고 다음 파일을 실행하세요:

1. `supabase/migrations/009_advertisement_system.sql` (아직 안 했다면)
2. `supabase/migrations/010_set_admin_email.sql` (아직 안 했다면)
3. `supabase/migrations/011_homepage_settings.sql` **(새로 추가됨!)**

```sql
-- 011_homepage_settings.sql 파일의 전체 내용을 복사하여 실행
```

### 2단계: 관리자 페이지에서 설정

1. 관리자 계정(`3rdtwenty@gmail.com`)으로 로그인
2. 관리자 페이지 → **설정** 메뉴 클릭
3. 홈페이지 설정 조정:

   **슬라이드 개수 설정**
   - 전체 슬라이드 수: 5 (권장)
   - 기사 슬라이드 수: 3
   - 광고 슬라이드 수: 2

   **슬라이드에 표시할 카테고리**
   - 원하는 카테고리 선택 (예: 패션, 뷰티, 여행)
   - 선택된 카테고리의 최신 기사가 슬라이드에 표시됩니다

   **자동 재생 설정**
   - 자동 재생 활성화: ✓ (체크)
   - 전환 간격: 5000ms (5초)

4. **저장** 버튼 클릭

### 3단계: 광고 업로드 (선택사항)

슬라이드에 광고를 표시하려면:

1. 관리자 페이지 → **광고 관리** 메뉴
2. 새 광고 추가:
   - 제목: 광고 제목
   - 이미지: 광고 이미지 업로드
   - 링크: 클릭 시 이동할 URL
   - **위치**: `inline` 선택 (슬라이드용)
   - 활성화: ✓
3. 저장

## 작동 방식

### 슬라이드 구성 로직

1. **기사 수집**
   - 설정된 카테고리에서 최신 기사를 각각 1개씩 수집
   - 설정된 기사 슬라이드 수만큼 수집

2. **광고 추가**
   - `position='inline'`인 활성 광고 조회
   - 설정된 광고 슬라이드 수만큼 추가

3. **최종 슬라이드**
   - 기사 + 광고를 합쳐서 슬라이드 구성
   - 전체 슬라이드 수 제한 적용

### 예시

설정:
- 전체 슬라이드 수: 5
- 기사 슬라이드 수: 3
- 광고 슬라이드 수: 2
- 선택 카테고리: 패션, 뷰티, 여행

결과 슬라이드:
1. 패션 최신 기사
2. 뷰티 최신 기사
3. 여행 최신 기사
4. 광고 1
5. 광고 2

## 유효성 검사

관리자 페이지에서 다음 사항을 자동으로 검증합니다:

- ⚠️ **기사 슬라이드 수 + 광고 슬라이드 수 ≤ 전체 슬라이드 수**
  - 초과 시 빨간색 경고 표시
  - 저장 버튼 비활성화

## 기본값

마이그레이션 실행 시 다음 기본값이 설정됩니다:

```json
{
  "total_slides": 5,
  "article_slides": 3,
  "ad_slides": 2,
  "slide_categories": ["fashion", "beauty", "travel"],
  "autoplay_enabled": true,
  "autoplay_interval": 5000
}
```

## 문제 해결

### 슬라이드에 광고가 안 나타나는 경우
1. 광고 관리에서 `position='inline'`인 광고가 있는지 확인
2. 광고가 활성화(`is_active=true`)되어 있는지 확인
3. 광고 슬라이드 수가 0보다 큰지 확인

### 설정이 적용되지 않는 경우
1. 브라우저 새로고침 (Ctrl+R 또는 Cmd+R)
2. 브라우저 캐시 삭제

### 특정 카테고리 기사가 안 나타나는 경우
1. 해당 카테고리에 발행된(`status='published'`) 기사가 있는지 확인
2. 카테고리 슬러그가 올바른지 확인 (예: `fashion`, `beauty`)

## 향후 개선 사항

다음 기능들을 추가로 구현할 수 있습니다:

1. **슬라이드 순서 커스터마이징**
   - 기사와 광고의 순서를 드래그 앤 드롭으로 조정

2. **슬라이드별 개별 설정**
   - 특정 기사를 슬라이드에 고정
   - 슬라이드별 노출 기간 설정

3. **A/B 테스팅**
   - 여러 슬라이드 구성을 테스트하여 최적화

4. **분석 데이터 연동**
   - 슬라이드 클릭률, 체류 시간 등 분석

## 요약

✅ 완료된 작업:
- 홈페이지 설정 데이터베이스 테이블 생성
- 설정 관리 UI 구현 (관리자 페이지)
- 동적 슬라이드 시스템 구현
- 광고 슬라이드 통합

⚠️ 필요한 작업:
- Supabase에서 `011_homepage_settings.sql` 마이그레이션 실행
- 관리자 페이지에서 원하는 설정 조정
- 광고 업로드 (선택사항)

모든 설정이 완료되면 메인 페이지의 슬라이드가 관리자가 지정한 대로 동작합니다!
